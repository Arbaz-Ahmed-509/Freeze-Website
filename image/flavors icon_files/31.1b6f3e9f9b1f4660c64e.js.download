(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{388:function(t,e,o){"use strict";o.r(e),o.d(e,"ColorPalette",function(){return p});var l=o(62),a=o(0),n=o(34),i=o(5),s=o(7),r=o(23),c=o(16),d=o(3),u=o(11);a.e.Pickr=l;var p=function(){function t(){}return t.init=function(e){var o;a.e.Resource.resource.type===(n.b.standard||n.b.icon)&&(null==(o=document.getElementById("section-color-palette"))||o.classList.remove("hidden"),this.colorPaletteButton=document.getElementById("color-palette"),this.savePaletteButton=document.getElementById("save-palette"),this.cancelEditionButton=document.getElementById("cancel-edition"),this.editPaletteInputButton=document.getElementById("edit-palette"),this.paletteEditColorPickerButton=document.querySelector("#palette-edit-color-picker button"),e?(this.getUserColorpalette(),this.colorPaletteButton.addEventListener("click",t.open),c.a.callModalRemovePalette(),t.handleListeners()):this.notPremiumUser())},t.getUserColorpalette=function(){var t=this,e=APP_URL+"ajax/user-palette";Object(s.a)(e).then(function(e){var o,l;(0!=e.success&&(t.palettes=e.data.palettes[0],t.drawSwatches()),t.palettes.colors.length>t.limitColorsIndex)?null==(o=t.paletteEditColorPickerButton)||o.classList.add("disabled"):null==(l=t.paletteEditColorPickerButton)||l.classList.remove("disabled")}).catch(function(t){throw t})},t.handleListeners=function(){var t,e,o,l=this;null==(t=this.editPaletteInputButton)||t.addEventListener("change",function(){var t;null!=(t=l.editPaletteInputButton)&&t.checked&&(l.isOnEdition=!0,l.showDeleteSwatchesButtons(),l.showSaveButton(),l.showCancelButton())}),null==(e=this.savePaletteButton)||e.addEventListener("click",function(){l.savePalette()}),null==(o=this.cancelEditionButton)||o.addEventListener("click",function(){l.cancelEdition()})},t.open=function(){var e;if(!(t.pickrPalette||null!=(e=this.paletteEditColorPickerButton)&&e.classList.contains("disabled"))){var o,l,n;i.a.send("ga","event","editor","add-custom-color","premium"),t.pickrPalette=a.e.Pickr.create({el:"#palette-edit-color-picker",container:".color-palette-wrapper",showAlways:!1,inline:!1,comparison:!1,useAsButton:!0,defaultRepresentation:"HEX",default:"#3A7C78",swatches:[],components:{preview:!1,opacity:!1,hue:!0,interaction:{hex:!1,rgba:!1,hsla:!1,hsva:!1,cmyk:!1,input:!0,clear:!1,save:!1}}});var s=document.createElement("button");s.id="save-button-palette",s.className="bj-button bj-button--sm font-sm bj-button--primary bj-button--green mg-none mg-top-lv2-i",s.innerText=messages.colorPalette.save,null==(o=document.querySelector(".color-palette-wrapper .pcr-app"))||o.appendChild(s),null==(l=document.querySelector(".color-palette-wrapper .pcr-result"))||l.setAttribute("maxlength","7"),null==(n=document.getElementById("save-button-palette"))||n.addEventListener("click",function(){t.saveColorToPalette()})}var r=document.querySelector(".color-palette-wrapper .pcr-app");r&&(r.style.display="flex")},t.saveColorToPalette=function(){var t=document.querySelector(".color-palette-wrapper .pcr-interaction .pcr-result");if(this.palettes.colors.length>this.limitColorsIndex){var e;null==(e=this.paletteEditColorPickerButton)||e.classList.add("disabled","tooltip__trigger","tooltip__trigger--always"),d.a.alert("notification-search",messages.colorPalette.exceeded,"warning","bottom-left",4500);var o=document.querySelector(".color-palette-wrapper .pcr-app");o&&(o.style.display="none")}else if(-1===this.palettes.colors.indexOf(t.value)){var l;if(this.palettes.colors.push(t.value),this.palettes.colors.length>this.limitColorsIndex)null==(l=this.paletteEditColorPickerButton)||l.classList.add("disabled","tooltip__trigger","tooltip__trigger--always");this.sendDataColorPalette()}else d.a.alert("notification-search",messages.colorPalette.alredyExist,"warning","bottom-left",4500);this.drawSwatches()},t.drawSwatches=function(){var e,o,l=this;document.querySelectorAll(".swatch").forEach(function(t){return t.remove()});var a,n=this.isOnEdition?"":"hidden";(this.palettes.colors.length>this.limitColorsIndex?null==(e=this.paletteEditColorPickerButton)||e.classList.add("disabled","tooltip__trigger","tooltip__trigger--always"):null==(o=this.paletteEditColorPickerButton)||o.classList.remove("disabled","tooltip__trigger","tooltip__trigger--always"),this.palettes.colors.length>0)&&(this.palettes.colors.forEach(function(t,e){var o,a=document.createElement("li");a.className="swatch mg-right-lv2 mg-bottom-lv2",a.innerHTML='<span class="color" style="background-color: '+t+';" title="'+t+'"><i class="icon icon--cross-small '+n+'" data-value="'+t+'"></i></span>',a.dataset.value=t,null==(o=document.querySelector("ul.swatches"))||o.appendChild(a);var i=a.querySelector("span.color");i&&l.handleSwatchListenerByColor(i)}),null==(a=document.querySelector(".color-palette__header .popover-button"))||a.classList.remove("hidden"));document.querySelectorAll(".swatch i").forEach(function(e){return e.addEventListener("click",function(e){e.stopPropagation();var o=e.target.dataset.value;o&&t.deleteSwatch(o)})})},t.deleteSwatch=function(t){this.palettes.colors=this.palettes.colors.filter(function(e){return e!==t}),this.drawSwatches(),0===this.palettes.colors.length&&(this.editPaletteInputButton&&(this.editPaletteInputButton.checked=!1),this.isOnEdition=!1)},t.showDeleteSwatchesButtons=function(){document.querySelectorAll(".swatch i").forEach(function(t){return t.classList.remove("hidden")})},t.showSaveButton=function(){var t;null==(t=this.savePaletteButton)||t.classList.remove("hidden")},t.showCancelButton=function(){var t;null==(t=this.cancelEditionButton)||t.classList.remove("hidden")},t.savePalette=function(){var t,e,o;(this.palettes.colors=this.palettes.colors,document.getElementById("edit-palette").checked=!1,this.isOnEdition=!1,null==(t=this.savePaletteButton)||t.classList.add("hidden"),null==(e=this.cancelEditionButton)||e.classList.add("hidden"),this.sendDataColorPalette(),this.drawSwatches(),0===this.palettes.colors.length)&&(null==(o=document.querySelector(".color-palette__header .popover-button"))||o.classList.add("hidden"))},t.cancelEdition=function(){var t,e;document.getElementById("edit-palette").checked=!1,this.isOnEdition=!1,null==(t=this.cancelEditionButton)||t.classList.add("hidden"),null==(e=this.savePaletteButton)||e.classList.add("hidden"),this.getUserColorpalette(),this.drawSwatches()},t.removePalette=function(){var e;t.palettes.colors=[],t.savePalette(),document.querySelector(".modal-remove-palette .modal__close").click(),null==(e=document.querySelector(".color-palette__header .popover-button"))||e.classList.add("hidden")},t.noThanks=function(){document.querySelector(".modal-remove-palette .modal__close").click()},t.notPremiumUser=function(){var t,e=document.querySelector("section.color-palette .color-palette__header");e.style.display="block",e.querySelector("p").style.display="inline",null==(t=e.querySelector("i"))||t.classList.remove("hidden"),this.colorPaletteButton.classList.add("modal__trigger"),this.colorPaletteButton.dataset.modal="modal-palette-not-premium-user",c.a.callModalPaletteNotPremiumUser(),window.addEventListener("modal-loaded-modal-palette-not-premium-user",function(){var t;null==(t=document.querySelector("#modal-palette-not-premium-user a"))||t.addEventListener("click",function(){i.a.send("ga","event","editor","add-custom-color","registered"),i.a.send("ga4dl",{event:"ga4event",event_name:"microfunnel",location:"popup_custom_palette",interaction_type:"click",action:"go_premium",product_price:"full_price",campaign_name:"no_campaign",discount_type:"0"})})})},t.sendDataColorPalette=function(){var t=APP_URL+"ajax/user-palette/"+this.palettes.id;Object(s.a)(t,{method:"POST",data:JSON.stringify({colors:this.palettes.colors}),headers:{"X-Requested-With":"XMLHttpRequest"}}).catch(function(t){d.a.alert("notification-colorpalette",messages.colorPalette.updatingError,"warning","bottom-left")})},t.handleSwatchListenerByColor=function(t){var e=this;null==t||t.addEventListener("click",function(t){var o=t.currentTarget;!e.isOnEdition&&o&&o.title&&(document.querySelector("#svg-icon-colors .color .active").style.background.includes("linear-gradient")?d.a.alert("notification-colorpalette",messages.colorPalette.noGradients,"warning","bottom-left"):(u.Editor.pickr.setColor(o.title.toLowerCase()),r.Color.fireChangeColor(o.title.toLowerCase(),!0),r.Color.setSVGColor(o.title.toLowerCase())))})},t}();p.isOnEdition=!1,p.limitColorsIndex=10}}]);
//# sourceMappingURL=31.1b6f3e9f9b1f4660c64e.js.map